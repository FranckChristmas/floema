/*! For license information please see main.facd53396cf03df7ecea.hot-update.js.LICENSE.txt */
"use strict";self.webpackHotUpdatefloema("main",{"./app/components/Canvas/Index.js":(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var i=s("./node_modules/ogl/src/core/Renderer.js"),n=s("./node_modules/ogl/src/core/Camera.js"),o=s("./node_modules/ogl/src/core/Transform.js"),a=s("./app/components/Canvas/Home/Index.js"),h=s("./app/components/Canvas/About/Index.js"),c=s("./app/components/Canvas/Collections/Index.js");class d{constructor({template:e}){this.template=e,this.x={start:0,distance:0,end:0},this.y={start:0,distance:0,end:0},this.createCamera(),this.createRenderer(),this.createScene(),this.onResize()}createRenderer(){this.renderer=new i.Renderer({alpha:!0,antialias:!0}),this.gl=this.renderer.gl,document.body.appendChild(this.gl.canvas)}createCamera(){this.camera=new n.Camera(this.gl),this.camera.position.z=5}createScene(){this.scene=new o.Transform}createHome(){this.home=new a.default({gl:this.gl,scene:this.scene,sizes:this.sizes})}destroyHome(){this.home&&(this.home.destroy(),this.home=null)}createCollections(){this.collections=new c.default({gl:this.gl,scene:this.scene,sizes:this.sizes})}destroyCollections(){this.collections&&(this.collections.destroy(),this.collections=null)}createAbout(){this.about=new h.default({gl:this.gl,scene:this.scene,sizes:this.sizes})}destroyAbout(){this.about&&(this.about.destroy(),this.about=null)}onPreloaded(){this.onChangeEnd(this.template)}onChangeStart(){this.about&&this.about.hide(),this.collections&&this.collections.hide(),this.home&&this.home.hide()}onChangeEnd(e){"about"===e?this.createAbout():this.about&&this.destroyAbout(),"collections"===e?this.createCollections():this.collections&&this.destroyCollections(),"home"===e?this.createHome():this.destroyHome()}onResize(){this.renderer.setSize(window.innerWidth,window.innerHeight),this.camera.perspective({aspect:window.innerWidth/window.innerHeight});const e=this.camera.fov*(Math.PI/180),t=2*Math.tan(e/2)*this.camera.position.z,s=t*this.camera.aspect;this.sizes={height:t,width:s};const i={sizes:this.sizes};this.about&&this.about.onResize(i),this.collections&&this.collections.onResize(i),this.home&&this.home.onResize(i)}onTouchDown(e){this.isDown=!0,this.x.start=e.touches?e.touches[0].clientX:e.clientX,this.y.start=e.touches?e.touches[0].clientY:e.clientY;const t={x:this.x,y:this.y};this.about&&this.about.onTouchDown(t),this.collections&&this.collections.onTouchDown(t),this.home&&this.home.onTouchDown(t)}onTouchMove(e){if(!this.isDown)return;const t=e.touches?e.touches[0].clientX:e.clientX,s=e.touches?e.touches[0].clientY:e.clientY;this.x.end=t,this.y.end=s;const i={x:this.x,y:this.y};this.about&&this.about.onTouchMove(i),this.collections&&this.collections.onTouchMove(i),this.home&&this.home.onTouchMove(i)}onTouchUp(e){this.isDown=!1;const t=e.changedTouches?e.changedTouches[0].clientX:e.clientX,s=e.changedTouches?e.changedTouches[0].clientY:e.clientY;this.x.end=t,this.y.end=s;const i={x:this.x,y:this.y};this.about&&this.about.onTouchUp(i),this.collections&&this.collections.onTouchUp(i),this.home&&this.home.onTouchUp(i)}onWheel(e){this.collections&&this.collections.onWheel(e),this.home&&this.home.onWheel(e)}update(e){this.collections&&this.collections.update(),this.about&&this.about.update(e),this.home&&this.home.update(),this.renderer.render({camera:this.camera,scene:this.scene})}}},"./app/index.js":(e,t,s)=>{s.r(t);var i=s("./node_modules/normalize-wheel/index.js"),n=s.n(i),o=s("./node_modules/lodash/each.js"),a=s.n(o),h=s("./app/components/Canvas/Index.js"),c=s("./app/components/preloader.js"),d=s("./app/pages/About/Index.js"),l=s("./app/pages/Collections/Index.js"),r=s("./app/pages/Detail/Index.js"),u=s("./app/pages/Home/Index.js"),p=s("./app/components/Navigation.js");class m{constructor(){this.createContent(),this.createCanvas(),this.createPreloader(),this.createNavigation(),this.createPages(),this.addEventListeners(),this.addLinkListeners(),this.onResize(),this.update()}createNavigation(){this.navigation=new p.default({template:this.template})}createPreloader(){this.preloader=new c.default({canvas:this.canvas}),this.preloader.once("completed",this.onPreloaded.bind(this))}createCanvas(){this.canvas=new h.default({template:this.template})}createContent(){this.content=document.querySelector(".content"),this.template=this.content.getAttribute("data-template")}createPages(){this.pages={about:new d.default,collections:new l.default,home:new u.default,detail:new r.default},this.page=this.pages[this.template],this.page.create()}onPreloaded(){this.onResize(),this.canvas.onPreloaded(),this.page.show()}async onChange(e){this.canvas.onChangeStart(this.template),await this.page.hide();const t=await window.fetch(e);if(200===t.status){const s=await t.text(),i=document.createElement("div");window.history.pushState({},"",e),i.innerHTML=s;const n=i.querySelector(".content");this.template=n.getAttribute("data-template"),this.navigation.onChange(this.template),this.content.setAttribute("data-template",this.template),this.content.innerHTML=n.innerHTML,this.canvas.onChangeEnd(this.template),this.page=this.pages[this.template],this.page.create(),this.onResize(),this.page.show(),this.addLinkListeners()}else console.log("errrrrrrrror")}onResize(){this.page&&this.page.onResize&&this.page.onResize(),window.requestAnimationFrame((e=>{this.canvas&&this.canvas.onResize&&this.canvas.onResize()}))}onTouchDown(e){this.canvas&&this.canvas.onTouchDown&&this.canvas.onTouchDown(e)}onTouchMove(e){this.canvas&&this.canvas.onTouchMove&&this.canvas.onTouchMove(e)}onTouchUp(e){this.canvas&&this.canvas.onTouchUp&&this.canvas.onTouchUp(e)}onWheel(e){const t=n()(e);this.canvas&&this.canvas.onWheel&&this.canvas.onWheel(t),this.page&&this.page.onWheel&&this.page.onWheel(t)}update(){this.page&&this.page.update&&this.page.update(),this.canvas&&this.canvas.update&&this.canvas.update(this.page.scroll),this.frame=window.requestAnimationFrame(this.update.bind(this))}addEventListeners(){window.addEventListener("mousewheel",this.onWheel.bind(this)),window.addEventListener("mousedown",this.onTouchDown.bind(this)),window.addEventListener("mousemove",this.onTouchMove.bind(this)),window.addEventListener("mouseup",this.onTouchUp.bind(this)),window.addEventListener("touchstart",this.onTouchDown.bind(this)),window.addEventListener("touchmove",this.onTouchMove.bind(this)),window.addEventListener("touchend",this.onTouchUp.bind(this)),window.addEventListener("resize",this.onResize.bind(this))}addLinkListeners(){const e=document.querySelectorAll("a");a()(e,(e=>{e.onclick=t=>{t.preventDefault();const{href:s}=e;this.onChange(s)}}))}}document.addEventListener("DOMContentLoaded",(()=>{new m}))}},(function(e){e.h=()=>"e1bb12f206a8ef2a48c2"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixRQUN6QmxFLEtBQUt5RixLQUFLdkIsU0FHUmxFLEtBQUtrQixRQUFVbEIsS0FBS2tCLE9BQU9nRCxRQUM3QmxFLEtBQUtrQixPQUFPZ0QsT0FBT2xFLEtBQUt5RixLQUFLdEIsUUFHL0JuRSxLQUFLZ0gsTUFBUXBFLE9BQU9nRSxzQkFBc0I1RyxLQUFLa0UsT0FBT2dCLEtBQUtsRixNQUM3RCxDQU1BMkUsaUJBQUFBLEdBQ0UvQixPQUFPcUUsaUJBQWlCLGFBQWNqSCxLQUFLaUUsUUFBUWlCLEtBQUtsRixPQUN4RDRDLE9BQU9xRSxpQkFBaUIsWUFBYWpILEtBQUt3RCxZQUFZMEIsS0FBS2xGLE9BQzNENEMsT0FBT3FFLGlCQUFpQixZQUFhakgsS0FBSzhELFlBQVlvQixLQUFLbEYsT0FDM0Q0QyxPQUFPcUUsaUJBQWlCLFVBQVdqSCxLQUFLK0QsVUFBVW1CLEtBQUtsRixPQUV2RDRDLE9BQU9xRSxpQkFBaUIsYUFBY2pILEtBQUt3RCxZQUFZMEIsS0FBS2xGLE9BQzVENEMsT0FBT3FFLGlCQUFpQixZQUFhakgsS0FBSzhELFlBQVlvQixLQUFLbEYsT0FDM0Q0QyxPQUFPcUUsaUJBQWlCLFdBQVlqSCxLQUFLK0QsVUFBVW1CLEtBQUtsRixPQUV4RDRDLE9BQU9xRSxpQkFBaUIsU0FBVWpILEtBQUtTLFNBQVN5RSxLQUFLbEYsTUFDdkQsQ0FFQTRFLGdCQUFBQSxHQUNFLE1BQU1zQyxFQUFRbkcsU0FBU29HLGlCQUFpQixLQUN4Q0MsSUFBS0YsR0FBT0csSUFDVkEsRUFBS0MsUUFBVTdELElBQ2JBLEVBQU04RCxpQkFFTixNQUFNLEtBQUVDLEdBQVNILEVBQ2ZySCxLQUFLNEYsU0FBUzRCLEVBQUssQ0FDdEIsR0FFTCxFQUVGekcsU0FBU2tHLGlCQUFpQixvQkFBb0IsS0FDOUMsSUFBSTVDLENBQUssbUJDNU1Ub0QsRUFBb0JDLEVBQUksSUFBTSIsInNvdXJjZXMiOlsid2VicGFjazovL2Zsb2VtYS8uL2FwcC9jb21wb25lbnRzL0NhbnZhcy9JbmRleC5qcyIsIndlYnBhY2s6Ly9mbG9lbWEvLi9hcHAvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZmxvZW1hL3dlYnBhY2svcnVudGltZS9nZXRGdWxsSGFzaCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYW1lcmEsIFJlbmRlcmVyLCBUcmFuc2Zvcm0gfSBmcm9tICdvZ2wnICBcblxuaW1wb3J0IEhvbWUgZnJvbSAnY29tcG9uZW50cy9DYW52YXMvSG9tZS9JbmRleCdcbmltcG9ydCBBYm91dCBmcm9tICdjb21wb25lbnRzL0NhbnZhcy9BYm91dC9JbmRleCdcbmltcG9ydCBDb2xsZWN0aW9ucyBmcm9tICdjb21wb25lbnRzL0NhbnZhcy9Db2xsZWN0aW9ucy9JbmRleCdcbi8vIENhbWVyYSwgUmVuZGVyZXIgYW5kIFRyYW5zZm9ybSBhcmUgdGhlIHRocmVlIGVsZW1lbnRzIG5lZWRlZCB0byBjcmVhdGUgYSAzRCBzY2VuZSAtXG4vLyBCb3gsIFByb2dyYW0gYW5kIE1lc2ggYXJlIHRoZSB0aHJlZSBlbGVtZW50cyBuZWVkZWQgdG8gY3JlYXRlIGEgM0Qgb2JqZWN0XG4vLyBhbGwgdGhlIGVsZW1lbnRzIGFyZSBpbXBvcnRlZCBmcm9tIHRoZSBvZ2wgbGlicmFyeVxuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbnZhcyB7XG4gIGNvbnN0cnVjdG9yICh7IHRlbXBsYXRlIH0pIHtcbiAgICB0aGlzLnRlbXBsYXRlID0gdGVtcGxhdGU7XG5cbiAgICB0aGlzLnggPSB7XG4gICAgICBzdGFydDogMCxcbiAgICAgIGRpc3RhbmNlOiAwLFxuICAgICAgZW5kOiAwLFxuICAgIH1cbiAgICB0aGlzLnkgPSB7XG4gICAgICBzdGFydDogMCxcbiAgICAgIGRpc3RhbmNlOiAwLFxuICAgICAgZW5kOiAwLFxuICAgIH1cbiAgICB0aGlzLmNyZWF0ZUNhbWVyYSgpXG4gICAgdGhpcy5jcmVhdGVSZW5kZXJlcigpXG4gICAgdGhpcy5jcmVhdGVTY2VuZSgpXG5cbiAgICB0aGlzLm9uUmVzaXplKClcbiAgfVxuXG4gIGNyZWF0ZVJlbmRlcmVyKCkge1xuICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIoeyAvLyBpdCBhbGxvd3NcbiAgICAgIGFscGhhOiB0cnVlLCAvLyBtYWtlIG91ciBjYW52YXMgdHJhbnNwYXJlbnRcbiAgICAgIGFudGlhbGlhczogdHJ1ZSwgLy8gbWFrZSBvdXIgY2FudmFzIHNtb290aFxuICAgIH0pXG5cbiAgICB0aGlzLmdsID0gdGhpcy5yZW5kZXJlci5nbFxuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmdsLmNhbnZhcylcbiAgfVxuXG4gIGNyZWF0ZUNhbWVyYSgpIHtcbiAgICB0aGlzLmNhbWVyYSA9IG5ldyBDYW1lcmEodGhpcy5nbClcbiAgICB0aGlzLmNhbWVyYS5wb3NpdGlvbi56ID0gNSAvLyBzZXQgdGhlIGNhbWVyYSBwb3NpdGlvbiBvbiB0aGUgei1heGlzIHRvIDVcbiAgfVxuXG4gIGNyZWF0ZVNjZW5lKCkge1xuICAgIHRoaXMuc2NlbmUgPSBuZXcgVHJhbnNmb3JtKClcbiAgfVxuICAvKipcbiAgICogSG9tZVxuICAqL1xuIGNyZWF0ZUhvbWUoKSB7XG4gICB0aGlzLmhvbWUgPSBuZXcgSG9tZSh7XG4gICAgIGdsOiB0aGlzLmdsLFxuICAgICBzY2VuZTogdGhpcy5zY2VuZSxcbiAgICAgc2l6ZXM6IHRoaXMuc2l6ZXNcbiAgIH0pXG4gfVxuIFxuICBkZXN0cm95SG9tZSgpIHtcbiAgICBpZiAoIXRoaXMuaG9tZSkgcmV0dXJuXG4gICAgdGhpcy5ob21lLmRlc3Ryb3koKVxuICAgIHRoaXMuaG9tZSA9IG51bGxcbiAgfVxuXG4gIC8qKlxuICAgKiBBYm91dFxuICAgKi9cbiAgY3JlYXRlQ29sbGVjdGlvbnMoKSB7XG4gICAgdGhpcy5jb2xsZWN0aW9ucyA9IG5ldyBDb2xsZWN0aW9ucyh7XG4gICAgICBnbDogdGhpcy5nbCxcbiAgICAgIHNjZW5lOiB0aGlzLnNjZW5lLFxuICAgICAgc2l6ZXM6IHRoaXMuc2l6ZXNcbiAgICB9KVxuICB9XG4gIGRlc3Ryb3lDb2xsZWN0aW9ucygpIHtcbiAgICBpZiAoIXRoaXMuY29sbGVjdGlvbnMpIHJldHVyblxuICAgIHRoaXMuY29sbGVjdGlvbnMuZGVzdHJveSgpXG4gICAgdGhpcy5jb2xsZWN0aW9ucyA9IG51bGxcbiAgfVxuXG4gICAgLyoqXG4gICAqIENvbGxlY3Rpb25zXG4gICAqL1xuICAgIGNyZWF0ZUFib3V0KCkge1xuICAgICAgdGhpcy5hYm91dCA9IG5ldyBBYm91dCh7XG4gICAgICAgIGdsOiB0aGlzLmdsLFxuICAgICAgICBzY2VuZTogdGhpcy5zY2VuZSxcbiAgICAgICAgc2l6ZXM6IHRoaXMuc2l6ZXNcbiAgICAgIH0pXG4gICAgfVxuICAgIGRlc3Ryb3lBYm91dCgpIHtcbiAgICAgIGlmICghdGhpcy5hYm91dCkgcmV0dXJuXG4gICAgICB0aGlzLmFib3V0LmRlc3Ryb3koKVxuICAgICAgdGhpcy5hYm91dCA9IG51bGxcbiAgICB9XG5cbi8qKlxuICogRXZlbnRzXG4gKi9cbm9uUHJlbG9hZGVkKCkge1xuICB0aGlzLm9uQ2hhbmdlRW5kKHRoaXMudGVtcGxhdGUpXG59XG5cbiAgb25DaGFuZ2VTdGFydCgpIHtcbiAgICBpZiAodGhpcy5hYm91dCkge1xuICAgICAgdGhpcy5hYm91dC5oaWRlKClcbiAgICB9IFxuXG4gICAgaWYgKHRoaXMuY29sbGVjdGlvbnMpIHtcbiAgICAgIHRoaXMuY29sbGVjdGlvbnMuaGlkZSgpXG4gICAgfSBcblxuICAgIGlmICh0aGlzLmhvbWUpIHtcbiAgICAgIHRoaXMuaG9tZS5oaWRlKClcbiAgICB9XG5cbiAgfVxuXG4gIG9uQ2hhbmdlRW5kKHRlbXBsYXRlKSB7XG4gICAgaWYgKHRlbXBsYXRlID09PSAnYWJvdXQnKSB7XG4gICAgICB0aGlzLmNyZWF0ZUFib3V0KClcbiAgICB9IGVsc2UgaWYgKHRoaXMuYWJvdXQpIHtcbiAgICAgIHRoaXMuZGVzdHJveUFib3V0KClcbiAgICB9XG5cbiAgICBpZiAodGVtcGxhdGUgPT09ICdjb2xsZWN0aW9ucycpIHtcbiAgICAgIHRoaXMuY3JlYXRlQ29sbGVjdGlvbnMoKVxuXG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbGxlY3Rpb25zKSB7XG4gICAgICB0aGlzLmRlc3Ryb3lDb2xsZWN0aW9ucygpXG4gICAgfVxuXG4gICAgaWYgKHRlbXBsYXRlID09PSAnaG9tZScpIHtcbiAgICAgIHRoaXMuY3JlYXRlSG9tZSgpXG4gICAgfSBlbHNlICB7XG4gICAgICB0aGlzLmRlc3Ryb3lIb21lKClcbiAgICB9XG4gIH1cblxuXG5cbiAgb25SZXNpemUoKSB7XG4gICAgdGhpcy5yZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpXG4gICAgXG4gICAgdGhpcy5jYW1lcmEucGVyc3BlY3RpdmUoe1xuICAgICAgYXNwZWN0OiB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodFxuICAgIH0pO1xuICAgIGNvbnN0IGZvdiA9IHRoaXMuY2FtZXJhLmZvdiAqIChNYXRoLlBJIC8gMTgwKVxuICAgIGNvbnN0IGhlaWdodCA9IDIgKiBNYXRoLnRhbihmb3YgLyAyKSAqIHRoaXMuY2FtZXJhLnBvc2l0aW9uLnpcbiAgICBjb25zdCB3aWR0aCA9IGhlaWdodCAqIHRoaXMuY2FtZXJhLmFzcGVjdFxuXG4gICAgdGhpcy5zaXplcyA9IHtcbiAgICAgIGhlaWdodCxcbiAgICAgIHdpZHRoXG4gICAgfVxuXG4gICAgY29uc3QgdmFsdWVzID0ge1xuICAgICAgc2l6ZXM6IHRoaXMuc2l6ZXNcbiAgICB9XG5cbiAgaWYgKHRoaXMuYWJvdXQpIHtcbiAgICB0aGlzLmFib3V0Lm9uUmVzaXplKHZhbHVlcylcbiAgfVxuXG4gIGlmICh0aGlzLmNvbGxlY3Rpb25zKSB7XG4gICAgdGhpcy5jb2xsZWN0aW9ucy5vblJlc2l6ZSh2YWx1ZXMpXG4gIH1cblxuICBpZiAodGhpcy5ob21lKSB7XG4gICAgdGhpcy5ob21lLm9uUmVzaXplKHZhbHVlcylcbiAgfVxuXG4gIH1cblxuICBvblRvdWNoRG93bihldmVudCkge1xuICAgIHRoaXMuaXNEb3duID0gdHJ1ZVxuICAgIHRoaXMueC5zdGFydCA9IGV2ZW50LnRvdWNoZXMgPyBldmVudC50b3VjaGVzWzBdLmNsaWVudFggOiBldmVudC5jbGllbnRYXG4gICAgdGhpcy55LnN0YXJ0ID0gZXZlbnQudG91Y2hlcyA/IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WSA6IGV2ZW50LmNsaWVudFlcblxuICAgIGNvbnN0IHZhbHVlcyA9IHtcbiAgICAgIHg6IHRoaXMueCxcbiAgICAgIHk6IHRoaXMueSxcbiAgICB9XG5cbiAgICBpZih0aGlzLmFib3V0KSB7XG4gICAgICB0aGlzLmFib3V0Lm9uVG91Y2hEb3duKHZhbHVlcylcbiAgICB9XG4gICAgaWYodGhpcy5jb2xsZWN0aW9ucykge1xuICAgICAgdGhpcy5jb2xsZWN0aW9ucy5vblRvdWNoRG93bih2YWx1ZXMpXG4gICAgfVxuICAgXG4gICAgaWYodGhpcy5ob21lKSB7XG4gICAgICB0aGlzLmhvbWUub25Ub3VjaERvd24odmFsdWVzKVxuICAgIH1cbiAgfVxuICBvblRvdWNoTW92ZShldmVudCkgeyAvLyBhbGxvd3MgdG8gbW92ZSB0aGUgd2ViIEdMIHBhZ2Ugd2l0aCB0aGUgbW91c2VcbiAgICBpZiAoIXRoaXMuaXNEb3duKSByZXR1cm5cblxuICAgIGNvbnN0IHggPSBldmVudC50b3VjaGVzID8gZXZlbnQudG91Y2hlc1swXS5jbGllbnRYIDogZXZlbnQuY2xpZW50WFxuICAgIGNvbnN0IHkgPSBldmVudC50b3VjaGVzID8gZXZlbnQudG91Y2hlc1swXS5jbGllbnRZIDogZXZlbnQuY2xpZW50WVxuXG4gICAgdGhpcy54LmVuZCA9IHhcbiAgICB0aGlzLnkuZW5kID0geVxuXG4gICAgY29uc3QgdmFsdWVzID0ge1xuICAgICAgeDogdGhpcy54LFxuICAgICAgeTogdGhpcy55LFxuICAgIH1cblxuICAgIGlmKHRoaXMuYWJvdXQpIHtcbiAgICAgIHRoaXMuYWJvdXQub25Ub3VjaE1vdmUodmFsdWVzKVxuICAgIH1cblxuICAgIGlmKHRoaXMuY29sbGVjdGlvbnMpIHtcbiAgICAgIHRoaXMuY29sbGVjdGlvbnMub25Ub3VjaE1vdmUodmFsdWVzKVxuICAgIH1cbiAgIFxuICAgIGlmKHRoaXMuaG9tZSkge1xuICAgICAgdGhpcy5ob21lLm9uVG91Y2hNb3ZlKHZhbHVlcylcbiAgICB9XG4gIH1cblxuICBvblRvdWNoVXAoZXZlbnQpIHtcbiAgICB0aGlzLmlzRG93biA9IGZhbHNlXG4gICAgY29uc3QgeCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzID8gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WCA6IGV2ZW50LmNsaWVudFhcbiAgICBjb25zdCB5ID0gZXZlbnQuY2hhbmdlZFRvdWNoZXMgPyBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZIDogZXZlbnQuY2xpZW50WVxuXG4gICAgdGhpcy54LmVuZCA9IHhcbiAgICB0aGlzLnkuZW5kID0geVxuXG4gICAgLy8gdGhpcy54LmRpc3RhbmNlID0gdGhpcy54LnN0YXJ0IC0gdGhpcy54LmVuZFxuICAgIC8vIHRoaXMueS5kaXN0YW5jZSA9IHRoaXMueS5zdGFydCAtIHRoaXMueS5lbmRcblxuICAgIGNvbnN0IHZhbHVlcyA9IHtcbiAgICAgIHg6IHRoaXMueCxcbiAgICAgIHk6IHRoaXMueSxcbiAgICB9XG5cbiAgICBpZih0aGlzLmFib3V0KSB7XG4gICAgICB0aGlzLmFib3V0Lm9uVG91Y2hVcCh2YWx1ZXMpXG4gICAgfVxuXG4gICAgaWYodGhpcy5jb2xsZWN0aW9ucykge1xuICAgICAgdGhpcy5jb2xsZWN0aW9ucy5vblRvdWNoVXAodmFsdWVzKVxuICAgIH1cbiAgXG4gICAgaWYodGhpcy5ob21lKSB7XG4gICAgICB0aGlzLmhvbWUub25Ub3VjaFVwKHZhbHVlcylcbiAgICB9XG4gIH0gXG5cbiAgb25XaGVlbChldmVudCkge1xuICAgIGlmKHRoaXMuY29sbGVjdGlvbnMpIHtcbiAgICAgIHRoaXMuY29sbGVjdGlvbnMub25XaGVlbChldmVudCkgXG4gICAgfVxuXG4gICAgaWYodGhpcy5ob21lKSB7XG4gICAgICB0aGlzLmhvbWUub25XaGVlbChldmVudCkgXG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBMb29wc1xuICAgKi9cbiAgdXBkYXRlKHNjcm9sbCkge1xuICAgIGlmICh0aGlzLmNvbGxlY3Rpb25zKSB7XG4gICAgICB0aGlzLmNvbGxlY3Rpb25zLnVwZGF0ZSgpXG4gICAgfVxuICAgIGlmICh0aGlzLmFib3V0KSB7XG4gICAgICB0aGlzLmFib3V0LnVwZGF0ZShzY3JvbGwpXG4gICAgfVxuICAgIGlmKHRoaXMuaG9tZSkge1xuICAgICAgdGhpcy5ob21lLnVwZGF0ZSgpXG4gICAgfVxuICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHtcbiAgICAgIGNhbWVyYTogdGhpcy5jYW1lcmEsXG4gICAgICBzY2VuZTogdGhpcy5zY2VuZSxcbiAgICB9KVxuICB9XG59XG5cblxuIiwiLy8gc2NyaXB0KHNyYz1cIi9tYWluLmpzXCIpXG5pbXBvcnQgTm9ybWFsaXplV2hlZWwgZnJvbSAnbm9ybWFsaXplLXdoZWVsJ1xuaW1wb3J0IGVhY2ggZnJvbSAnbG9kYXNoL2VhY2gnIC8vLSBsaWJyYXJ5IHRvIHVzZSBlYWNoIGluc3RlYWQgb2YgZm9yRWFjaCBtZXRob2QsIHdoaWNoIGlzbid0IGF2YWlsYWJsZSBpbiBOb2RlLmpzXG5pbXBvcnQgQ2FudmFzIGZyb20gJy4vY29tcG9uZW50cy9DYW52YXMvSW5kZXgnXG5pbXBvcnQgUHJlbG9hZGVyIGZyb20gJy4vY29tcG9uZW50cy9wcmVsb2FkZXInXG5pbXBvcnQgQWJvdXQgZnJvbSAnLi9wYWdlcy9BYm91dC9JbmRleCdcbmltcG9ydCBDb2xsZWN0aW9ucyBmcm9tICcuL3BhZ2VzL0NvbGxlY3Rpb25zL0luZGV4J1xuaW1wb3J0IERldGFpbCBmcm9tICcuL3BhZ2VzL0RldGFpbC9JbmRleCdcbmltcG9ydCBIb21lIGZyb20gJy4vcGFnZXMvSG9tZS9JbmRleCdcbmltcG9ydCBOYXZpZ2F0aW9uIGZyb20gJy4vY29tcG9uZW50cy9OYXZpZ2F0aW9uJ1xuXG5jbGFzcyBBcHAge1xuICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgdGhpcy5jcmVhdGVDb250ZW50KClcbiAgICB0aGlzLmNyZWF0ZUNhbnZhcygpXG4gICAgdGhpcy5jcmVhdGVQcmVsb2FkZXIoKVxuICAgIHRoaXMuY3JlYXRlTmF2aWdhdGlvbigpXG4gICAgdGhpcy5jcmVhdGVQYWdlcygpXG5cbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzKClcbiAgICB0aGlzLmFkZExpbmtMaXN0ZW5lcnMoKSAvLyByb3V0aW5nIHRoZSBwYWdlc1xuXG4gICAgdGhpcy5vblJlc2l6ZSgpXG5cbiAgICB0aGlzLnVwZGF0ZSgpXG4gIH1cblxuICBjcmVhdGVOYXZpZ2F0aW9uKCkge1xuICAgIHRoaXMubmF2aWdhdGlvbiA9IG5ldyBOYXZpZ2F0aW9uKHtcbiAgICAgIHRlbXBsYXRlOiB0aGlzLnRlbXBsYXRlLFxuICAgIH0pO1xuICB9XG5cbiAgY3JlYXRlUHJlbG9hZGVyICgpIHtcbiAgICB0aGlzLnByZWxvYWRlciA9IG5ldyBQcmVsb2FkZXIoe2NhbnZhcyA6IHRoaXMuY2FudmFzfSlcbiAgICB0aGlzLnByZWxvYWRlci5vbmNlKCdjb21wbGV0ZWQnLCB0aGlzLm9uUHJlbG9hZGVkLmJpbmQodGhpcykpXG5cbiAgfVxuXG4gIGNyZWF0ZUNhbnZhcygpIHtcbiAgICB0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXMoe1xuICAgICAgdGVtcGxhdGU6IHRoaXMudGVtcGxhdGUsXG4gICAgfSlcbiAgfVxuXG4gIGNyZWF0ZUNvbnRlbnQgKCkge1xuICAgIHRoaXMuY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JylcbiAgICB0aGlzLnRlbXBsYXRlID0gdGhpcy5jb250ZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10ZW1wbGF0ZScpXG4gIH1cblxuICBjcmVhdGVQYWdlcyAoKSAge1xuICAgIHRoaXMucGFnZXMgPSB7XG4gICAgICBhYm91dDogbmV3IEFib3V0KCksXG4gICAgICBjb2xsZWN0aW9uczogbmV3IENvbGxlY3Rpb25zKCksXG4gICAgICBob21lOiBuZXcgSG9tZSgpLFxuICAgICAgZGV0YWlsOiBuZXcgRGV0YWlsKCksXG4gICAgfVxuXG4gICAgdGhpcy5wYWdlID0gdGhpcy5wYWdlc1t0aGlzLnRlbXBsYXRlXVxuICAgIHRoaXMucGFnZS5jcmVhdGUoKVxuICB9XG5cbiAgLyoqKlxuICAgKiBFdmVudHNcbiAgICovXG4gIG9uUHJlbG9hZGVkKCkge1xuICAgIHRoaXMub25SZXNpemUoKVxuXG4gICAgdGhpcy5jYW52YXMub25QcmVsb2FkZWQoKVxuICAgICAgICBcbiAgICB0aGlzLnBhZ2Uuc2hvdygpXG5cbiAgfVxuXG4gIGFzeW5jIG9uQ2hhbmdlKHVybCkge1xuICAgIHRoaXMuY2FudmFzLm9uQ2hhbmdlU3RhcnQodGhpcy50ZW1wbGF0ZSlcbiAgICBhd2FpdCB0aGlzLnBhZ2UuaGlkZSgpIC8vaGlkZSB0aGUgY3VycmVudCBwYWdlXG5cbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgd2luZG93LmZldGNoKHVybCkgLy8tIGZldGNoIHRoZSBuZXcgcGFnZSBoZXJlIC0gYXN5bmMvYXdhaXQgYWxsb3cgYXN5bmNocm9uZXMgcmVxdWVzdHMgZm9ydiBmZXRjaGluZyBkYXRhXG4gICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSAyMDApIHtcbiAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXF1ZXN0LnRleHQoKVxuICAgICAgY29uc3QgZGl2PSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sICcnLCB1cmwpIC8vIHRvIHVwZGF0ZSB0aGUgdXJsIG9mIHRoZSBwYWdlXG5cbiAgICAgIGRpdi5pbm5lckhUTUwgPSBodG1sXG5cbiAgICAgIGNvbnN0IGRpdkNvbnRlbnQgPSBkaXYucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKVxuXG4gICAgICB0aGlzLnRlbXBsYXRlID0gZGl2Q29udGVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGVtcGxhdGUnKSAvLyB3aXRoIHRoaXMgbGluZSwgd2UgY2FuIGdldCB0aGUgdGVtcGxhdGUgb2YgdGhlIG5ldyBwYWdlXG4gICAgICBcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2FudmFzOlwiLCB0aGlzLmNhbnZhcyk7XG5cbiAgICAgIFxuICAgICAgdGhpcy5uYXZpZ2F0aW9uLm9uQ2hhbmdlKHRoaXMudGVtcGxhdGUpXG4gICAgICBcbiAgICAgIHRoaXMuY29udGVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGVtcGxhdGUnLCB0aGlzLnRlbXBsYXRlKSAvLyB3aXRoIHRoaXMgbGluZSwgd2UgY2FuIHNldCB0aGUgdGVtcGxhdGUgb2YgdGhlIG5ldyBwYWdlXG4gICAgICBcbiAgICAgIHRoaXMuY29udGVudC5pbm5lckhUTUwgPSBkaXZDb250ZW50LmlubmVySFRNTCAgXG4gICAgICBcbiAgICAgIHRoaXMuY2FudmFzLm9uQ2hhbmdlRW5kKHRoaXMudGVtcGxhdGUpXG4gICAgICBcbiAgICAgIHRoaXMucGFnZSA9IHRoaXMucGFnZXNbdGhpcy50ZW1wbGF0ZV1cbiAgICAgIFxuICAgICAgdGhpcy5wYWdlLmNyZWF0ZSgpXG4gICAgICBcbiAgICAgIHRoaXMub25SZXNpemUoKVxuICAgICAgXG4gICAgICB0aGlzLnBhZ2Uuc2hvdygpXG4gICAgICBcbiAgICAgIHRoaXMuYWRkTGlua0xpc3RlbmVycygpXG4gICAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZygnZXJycnJycnJycm9yJylcbiAgfVxufVxuXG5vblJlc2l6ZSgpIHtcbiAgaWYgKHRoaXMucGFnZSAmJiB0aGlzLnBhZ2Uub25SZXNpemUpIHsgLy8gdG8gZXhwbGFpbiA6IGlmIHRoZSBwYWdlIGV4aXN0cyBhbmQgdGhlIG1ldGhvZCBvblJlc2l6ZSBvZiB0aGUgcGFnZSBleGlzdHMsIHRoZW4gZXhlY3V0ZSB0aGUgbWV0aG9kIG9uUmVzaXplIG9mIHRoZSBwYWdlXG4gICAgdGhpcy5wYWdlLm9uUmVzaXplKClcbiAgfVxuICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKChfKSA9PiB7XG4gICAgaWYgKHRoaXMuY2FudmFzICYmIHRoaXMuY2FudmFzLm9uUmVzaXplKSB7ICBcbiAgICAgIHRoaXMuY2FudmFzLm9uUmVzaXplKClcbiAgICB9XG4gIH0pXG59XG4vLyBpZiAodGhpcy5jYW52YXMgJiYgdGhpcy5jYW52YXMub25SZXNpemUpIHsgIC8vIHRvIGV4cGxhaW4gOiBpZiB0aGUgY2FudmFzIGV4aXN0cyBhbmQgdGhlIG1ldGhvZCBvblJlc2l6ZSBvZiB0aGUgY2FudmFzIGV4aXN0cywgdGhlbiBleGVjdXRlIHRoZSBtZXRob2Qgb25SZXNpemUgb2YgdGhlIGNhbnZhc1xuLy8gICB0aGlzLmNhbnZhcy5vblJlc2l6ZSgpXG4vLyB9XG5cbm9uVG91Y2hEb3duKGV2ZW50KSB7XG4gIGlmICh0aGlzLmNhbnZhcyAmJiB0aGlzLmNhbnZhcy5vblRvdWNoRG93bikgeyAgXG4gICAgdGhpcy5jYW52YXMub25Ub3VjaERvd24oZXZlbnQpXG4gIH1cbn1cbm9uVG91Y2hNb3ZlKGV2ZW50KSB7XG4gIGlmICh0aGlzLmNhbnZhcyAmJiB0aGlzLmNhbnZhcy5vblRvdWNoTW92ZSkgeyAgXG4gICAgdGhpcy5jYW52YXMub25Ub3VjaE1vdmUoZXZlbnQpXG4gIH1cbiAgXG59XG5vblRvdWNoVXAoZXZlbnQpIHtcbiAgaWYgKHRoaXMuY2FudmFzICYmIHRoaXMuY2FudmFzLm9uVG91Y2hVcCkgeyAgXG4gICAgdGhpcy5jYW52YXMub25Ub3VjaFVwKGV2ZW50KVxuICB9XG59XG5cbm9uV2hlZWwoZXZlbnQpIHtcbiAgY29uc3Qgbm9ybWFsaXplV2hlZWwgPSBOb3JtYWxpemVXaGVlbChldmVudClcbiAgaWYgKHRoaXMuY2FudmFzICYmIHRoaXMuY2FudmFzLm9uV2hlZWwpIHtcbiAgICB0aGlzLmNhbnZhcy5vbldoZWVsKG5vcm1hbGl6ZVdoZWVsKVxuICB9XG5cbiAgaWYgKHRoaXMucGFnZSAmJiB0aGlzLnBhZ2Uub25XaGVlbCkge1xuICAgIHRoaXMucGFnZS5vbldoZWVsKG5vcm1hbGl6ZVdoZWVsKVxuICB9XG59XG5cbi8qKipcbiAqIExvb3BcbiAqL1xuICB1cGRhdGUoKSB7XG4gICAgXG4gICAgaWYgKHRoaXMucGFnZSAmJiB0aGlzLnBhZ2UudXBkYXRlKSB7XG4gICAgICB0aGlzLnBhZ2UudXBkYXRlKClcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jYW52YXMgJiYgdGhpcy5jYW52YXMudXBkYXRlKSB7XG4gICAgICB0aGlzLmNhbnZhcy51cGRhdGUodGhpcy5wYWdlLnNjcm9sbClcbiAgICB9XG5cbiAgICB0aGlzLmZyYW1lID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKVxuICB9XG5cbiAgLyoqKlxuICAgKiBMaXN0ZW5lcnNcbiAgICovXG5cbiAgYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNld2hlZWwnLCB0aGlzLm9uV2hlZWwuYmluZCh0aGlzKSlcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5vblRvdWNoRG93bi5iaW5kKHRoaXMpKVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uVG91Y2hNb3ZlLmJpbmQodGhpcykpXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm9uVG91Y2hVcC5iaW5kKHRoaXMpKVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLm9uVG91Y2hEb3duLmJpbmQodGhpcykpXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMub25Ub3VjaE1vdmUuYmluZCh0aGlzKSlcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLm9uVG91Y2hVcC5iaW5kKHRoaXMpKVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMub25SZXNpemUuYmluZCh0aGlzKSlcbiAgfVxuXG4gIGFkZExpbmtMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3QgbGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdhJykgLy8tIGdhdGhlciBhbGwgdGhlIGxpbmtzIG9mIHRoZSBwYWdlXG4gICAgZWFjaChsaW5rcywgbGluayA9PiB7XG4gICAgICBsaW5rLm9uY2xpY2sgPSBldmVudCA9PiB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHsgaHJlZiB9ID0gbGluayAvLy0gdG8gZ2V0IHRoZSB1cmwgbGluayBvZiB0aGUgcGFnZVxuICAgICAgICAgIHRoaXMub25DaGFuZ2UoaHJlZilcbiAgICAgIH1cbiAgICB9KVxuICB9XG59XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xubmV3IEFwcCgpXG59KSIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcImUxYmIxMmYyMDZhOGVmMmE0OGMyXCIpIl0sIm5hbWVzIjpbIkNhbnZhcyIsImNvbnN0cnVjdG9yIiwidGVtcGxhdGUiLCJ0aGlzIiwieCIsInN0YXJ0IiwiZGlzdGFuY2UiLCJlbmQiLCJ5IiwiY3JlYXRlQ2FtZXJhIiwiY3JlYXRlUmVuZGVyZXIiLCJjcmVhdGVTY2VuZSIsIm9uUmVzaXplIiwicmVuZGVyZXIiLCJSZW5kZXJlciIsImFscGhhIiwiYW50aWFsaWFzIiwiZ2wiLCJkb2N1bWVudCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImNhbnZhcyIsImNhbWVyYSIsIkNhbWVyYSIsInBvc2l0aW9uIiwieiIsInNjZW5lIiwiVHJhbnNmb3JtIiwiY3JlYXRlSG9tZSIsImhvbWUiLCJIb21lIiwic2l6ZXMiLCJkZXN0cm95SG9tZSIsImRlc3Ryb3kiLCJjcmVhdGVDb2xsZWN0aW9ucyIsImNvbGxlY3Rpb25zIiwiQ29sbGVjdGlvbnMiLCJkZXN0cm95Q29sbGVjdGlvbnMiLCJjcmVhdGVBYm91dCIsImFib3V0IiwiQWJvdXQiLCJkZXN0cm95QWJvdXQiLCJvblByZWxvYWRlZCIsIm9uQ2hhbmdlRW5kIiwib25DaGFuZ2VTdGFydCIsImhpZGUiLCJzZXRTaXplIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwicGVyc3BlY3RpdmUiLCJhc3BlY3QiLCJmb3YiLCJNYXRoIiwiUEkiLCJoZWlnaHQiLCJ0YW4iLCJ3aWR0aCIsInZhbHVlcyIsIm9uVG91Y2hEb3duIiwiZXZlbnQiLCJpc0Rvd24iLCJ0b3VjaGVzIiwiY2xpZW50WCIsImNsaWVudFkiLCJvblRvdWNoTW92ZSIsIm9uVG91Y2hVcCIsImNoYW5nZWRUb3VjaGVzIiwib25XaGVlbCIsInVwZGF0ZSIsInNjcm9sbCIsInJlbmRlciIsIkFwcCIsImNyZWF0ZUNvbnRlbnQiLCJjcmVhdGVDYW52YXMiLCJjcmVhdGVQcmVsb2FkZXIiLCJjcmVhdGVOYXZpZ2F0aW9uIiwiY3JlYXRlUGFnZXMiLCJhZGRFdmVudExpc3RlbmVycyIsImFkZExpbmtMaXN0ZW5lcnMiLCJuYXZpZ2F0aW9uIiwiTmF2aWdhdGlvbiIsInByZWxvYWRlciIsIlByZWxvYWRlciIsIm9uY2UiLCJiaW5kIiwiY29udGVudCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRBdHRyaWJ1dGUiLCJwYWdlcyIsImRldGFpbCIsIkRldGFpbCIsInBhZ2UiLCJjcmVhdGUiLCJzaG93Iiwib25DaGFuZ2UiLCJ1cmwiLCJyZXF1ZXN0IiwiZmV0Y2giLCJzdGF0dXMiLCJodG1sIiwidGV4dCIsImRpdiIsImNyZWF0ZUVsZW1lbnQiLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwiaW5uZXJIVE1MIiwiZGl2Q29udGVudCIsInNldEF0dHJpYnV0ZSIsImNvbnNvbGUiLCJsb2ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJfIiwibm9ybWFsaXplV2hlZWwiLCJOb3JtYWxpemVXaGVlbCIsImZyYW1lIiwiYWRkRXZlbnRMaXN0ZW5lciIsImxpbmtzIiwicXVlcnlTZWxlY3RvckFsbCIsImVhY2giLCJsaW5rIiwib25jbGljayIsInByZXZlbnREZWZhdWx0IiwiaHJlZiIsIl9fd2VicGFja19yZXF1aXJlX18iLCJoIl0sInNvdXJjZVJvb3QiOiIifQ==